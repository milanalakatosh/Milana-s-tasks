<!DOCTYPE html>
<html>
    <head>
        <title></title>
    </head>
    <body>
        <h3>Уровни узлов обработки запросов в Druid</h3>
        <p>
            Управление данными при помощи сегментов «проще себе представить» - эта концепция 
            хорошо ложится на наши когнитивные способности. Сами сегменты можно перемещать 
            между узлами относительно просто. Эта две причины позволили Druid реализовать 
            <i>“разделение на уровни”</i> узлов, занимающихся обработкой запросов: старые 
            данные автоматически перемещаются на сервера с относительно большими дисками, 
            но меньшим количеством памяти и CPU, что позволяет <b>значительно снизить 
            стоимость большого рабочего кластера Druid</b> за счет замедления запросов 
            к более старым данным.
        </p>
        <p>
            Эта функция позволяет Metamarkets экономить сотни тысяч долларов расходов 
            на инфраструктуру Druid каждый месяц - в противовес тому варианту, если бы 
            использовался “плоский” кластер.
        </p>
        <p>
            <img src="/Users/Istvan/Desktop/Снимок экрана 2021-08-18 в 14.08.41.png" alt="Уровни узлов обработки запросов в Druid">
        </p>
        <p>
            Насколько мне известно, в ClickHouse и Pinot пока еще нет похожей функциональности - 
            предполагается, что все узлы в их кластерах одинаковы.
        </p>
        <p>
            В силу того, что архитектура Pinot весьма схожа с архитектурой Druid, как мне 
            кажется, будет не слишком сложно добавить аналогичную функцию в Pinot. 
            Тяжелее будет в случае с ClickHouse, поскольку для реализации данной функции 
            крайне полезно использование концепта “сегментов”, однако это всё равно возможно.
        </p>
        <p>
            Во-вторых, вам стоит взглянуть на таблицу ниже. Каждая ячейка в этой таблице 
            описывает свойство приложения, которое позволит определить предпочтительную систему. 
            Строки отсортированы не в порядке важности. Важность различных свойств может 
            разниться от приложения к приложению, но в целом можно применить следующий подход: 
            если ваше приложение соответствует подавляющему большинству строк со свойствами в 
            одной из колонок, то относящаяся к ней система в вашем случае является 
            предпочтительным выбором.
        </p>
        <table border="1" bordercolor="#000000" cellspacing="0" cellpadding="10">
            <tr><th>ClickHouse </th><th>Druid или Pinot </th></tr>
            <tr><td>В организации есть эксперты по C++ </td><td>В организации есть эксперты по Java </td></tr>
            <tr><td>Малый кластер </td><td>Большой кластер </td></tr>
            <tr><td>Немного таблиц </td><td>Много таблиц </td></tr>
            <tr><td>Один набор данных </td><td>Несколько несвязанных наборов данных </td></tr>
            <tr>
                <td>Таблицы и данные находятся в кластере перманентно </td>
                <td>Таблицы и наборы данных периодически появляются в кластере и 
                    удаляются из него </td>
            </tr>
            <tr>
                <td>Размер таблиц (и интенсивность запросов к ним) остается стабильным во времени </td>
                <td>Таблицы значительно растут и сжимаются </td>
            </tr>
            <tr>
                <td>Однородные запросы (их тип, размер, распределение по времени суток и т.д.) </td>
                <td>Разнородные запросы </td></tr>
            <tr>
                <td>В данных есть измерение, по которому оно может быть сегментировано, и почти 
                    не выполняется запросов, которые затрагивают данные, расположенные в нескольких 
                    сегментах </td>
                <td>Подобного измерения нет, и запросы часто затрагивают данные, расположенные 
                    во всем кластере </td>
            </tr>
            <tr>
                <td>Облако не используется, кластер должен быть развернут на специфическую 
                    конфигурацию физических серверов </td>
                    <td>Кластер развернут в облаке </td>
            </tr>
            <tr>
                <td>Нет существующих кластеров Hadoop или Spark </td>
                <td>Кластеры Hadoop или Spark уже существуют и могут быть использованы </td>
            </tr>
        </table>
        <p>
            <b>Примечание</b>: ни одно из свойств выше не означает, что вы должны использовать 
            соответствующую систему (системы), или избегать другую. К примеру, если планируется, 
            что ваш кластер будет большим, это не значит, что вы обязательно должны рассматривать 
            только Druid или Pinot, исключив ClickHouse. Скорее всего, в данной ситуации Druid или 
            Pinot могут быть лучшим выбором, но другие полезные свойства могут перевесить чашу 
            весов в сторону ClickHouse, который для некоторых приложений является оптимальным 
            выбором даже для больших кластеров.
        </p>
    </body>
</html>